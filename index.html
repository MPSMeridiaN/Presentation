<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Control & Instrumentation (C&I) - EGAT Maintenance</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script>
        // Use EGAT colors for better branding uniformity
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'egat-blue': '#004d99',   /* สีน้ำเงินเข้มหลักของ EGAT */
                        'egat-yellow': '#FFD700', /* สีเหลือง/ทอง (Accent) ของ EGAT */
                    },
                }
            }
        }
    </script>

    <style>
        /* Sarabun Font Import for Thai language support and formal tone */
        @import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@100;300;400;500;600;700&family=Inter:wght@100..900&display=swap');
        
        body {
            font-family: 'Sarabun', 'Inter', sans-serif; 
            background-color: #ffffff;
        }

        /* Custom scrollbar style for better aesthetics */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        ::-webkit-scrollbar-thumb {
            background: #aab4c3;
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #7d899b;
        }
        
        /* Apply all transitions and default states via CSS for consistency */
        .content-section {
            transition: opacity 0.3s ease-in-out;
        }

        .dropdown-menu {
            display: none; 
            opacity: 0;
            transform: translateY(-10px);
            transition: opacity 0.3s ease-out, transform 0.3s ease-out;
            min-width: 250px;
        }

        .dropdown:hover .dropdown-menu {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }

        /* Active navigation link style (for JS control) */
        .nav-active-link {
            color: var(--egat-yellow, #FFD700) !important; 
            text-decoration: underline;
            text-decoration-thickness: 3px;
            text-underline-offset: 4px;
        }
        
        /* Modal Transitions: Use CSS classes that JS can toggle */
        .modal-backdrop-transition {
            transition: opacity 0.3s ease-out;
        }

        .modal-content-transition {
            transition: transform 0.3s ease-out, opacity 0.3s ease-out;
        }
    </style>

</head>
<body class="antialiased">
    
    <header class="bg-egat-blue shadow-xl sticky top-0 z-20">
        <div class="container mx-auto px-4 py-5 md:py-6 flex justify-between items-center">
            <h1 class="text-2xl md:text-3xl font-bold text-white tracking-tight">
                C&I Maintenance Team
            </h1>
            
            <nav id="main-nav" class="flex items-center">
                <a href="#overview" data-target="overview" class="nav-link text-white hover:text-egat-yellow transition duration-300 text-sm md:text-base ml-4 hover:underline nav-active-link font-bold">Overview</a>
                
                <a href="#details" data-target="details" class="nav-link text-white hover:text-egat-yellow transition duration-300 text-sm md:text-base ml-4 hover:underline">Details</a>
                
                <div class="relative ml-4 dropdown group">
                    <a href="#" data-target="training" class="nav-link text-white hover:text-egat-yellow transition duration-300 text-sm md:text-base hover:underline flex items-center">
                        On the Job Training
                        <svg class="w-4 h-4 ml-1 transform transition duration-300 group-hover:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </a>
                    <div class="dropdown-menu absolute top-full right-0 w-64 bg-egat-blue shadow-xl rounded-md overflow-hidden z-30 border border-egat-yellow/50">
                        
                        <a href="#combined_cycle" data-target="combined_cycle" data-parent-target="training" class="nav-link nav-dropdown-link block px-4 py-3 text-white text-sm hover:bg-egat-blue/70 hover:text-egat-yellow transition duration-200">
                            Combined Cycle Power Plant
                        </a>
                        
                        <a href="#solar_power" data-target="solar_power" data-parent-target="training" class="nav-link nav-dropdown-link block px-4 py-3 text-white text-sm hover:bg-egat-blue/70 hover:text-egat-yellow transition duration-200">
                            Solar Power Plant
                        </a>
                        
                    </div>
                </div>
            </nav>
            
        </div>
    </header>

    <main class="container mx-auto px-4 py-10 md:py-14">
        
        <section id="overview" class="content-section mb-16 opacity-100">
            <div class="max-w-5xl mx-auto p-8 rounded-xl shadow-2xl bg-white border border-gray-200">
                <div class="text-center">
                    <h2 class="text-3xl md:text-4xl font-extrabold text-egat-blue mb-2">
                        Control & Instrumentation (C&I)
                    </h2>
                    <h3 class="text-xl text-gray-700 font-medium mb-6">
                        Control & Instrumentation Maintenance Team Overview
                    </h3>
                    <p class="text-lg text-gray-600 max-w-4xl mx-auto border-b border-egat-yellow pb-4 mb-8">
                        C&I Maintenance Team คือหัวใจสำคัญในการรักษาความมั่นคงของระบบผลิตไฟฟ้า โดยรับผิดชอบดูแลและบำรุงรักษาระบบควบคุมอัตโนมัติ (DCS/PLC) และเครื่องมือวัดค่าทางกายภาพทั้งหมด เพื่อให้โรงไฟฟ้าทำงานด้วยประสิทธิภาพสูงสุดและปลอดภัยตามมาตรฐานสากล
                    </p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-center">
                    
                    <div class="p-6 rounded-lg bg-egat-blue/5 border border-egat-blue/20 shadow-md">
                        <svg class="w-8 h-8 mx-auto text-egat-blue mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                        <h4 class="font-semibold text-lg text-gray-800 mb-1">System Stability</h4>
                        <p class="text-sm text-gray-600">รับประกันความต่อเนื่องในการควบคุมกระบวนการผลิตไฟฟ้า</p>
                    </div>

                    <div class="p-6 rounded-lg bg-egat-blue/5 border border-egat-blue/20 shadow-md">
                        <svg class="w-8 h-8 mx-auto text-egat-blue mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                        <h4 class="font-semibold text-lg text-gray-800 mb-1">Maximum Efficiency</h4>
                        <p class="text-sm text-gray-600">การสอบเทียบและบำรุงรักษาเชิงรุกเพื่อลดการสูญเสียพลังงาน</p>
                    </div>

                    <div class="p-6 rounded-lg bg-egat-blue/5 border border-egat-blue/20 shadow-md">
                        <svg class="w-8 h-8 mx-auto text-egat-blue mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" />
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4" />
                        </svg>
                        <h4 class="font-semibold text-lg text-gray-800 mb-1">Reliability & Safety</h4>
                        <p class="text-sm text-gray-600">ดูแลระบบ SIS และอุปกรณ์ป้องกันอันตรายให้พร้อมใช้งานเสมอ</p>
                    </div>
                </div>
            </div>
        </section>


        <section id="details" class="content-section hidden mb-16 opacity-0">
            <div class="max-w-5xl mx-auto p-8 rounded-xl shadow-2xl bg-white border border-gray-200">
                
                <h2 class="text-3xl md:text-4xl font-extrabold text-egat-blue mb-2 text-center">
                    Work Details
                </h2>
                <p class="text-lg text-gray-600 max-w-4xl mx-auto border-b border-egat-yellow pb-4 mb-8 text-center">
                    คลิกที่หัวข้อด้านล่างเพื่อดูรายละเอียดเชิงลึกเกี่ยวกับขอบเขตความรับผิดชอบและหน้าที่หลักของทีม C&I
                </p>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <!-- Uniformity: Used bg-gray-50, p-6, and hover:shadow-lg, hover:ring-2 for consistent card design -->
                    <div class="detail-card bg-gray-50 p-6 rounded-xl shadow-md hover:shadow-lg transition duration-300 cursor-pointer hover:ring-2 hover:ring-egat-blue" data-detail="intro">
                        <div class="flex items-center justify-between mb-3">
                            <span class="text-4xl text-egat-blue">📝</span>
                        </div>
                        <h3 class="text-xl font-semibold text-egat-blue mb-1">Introduction & Organizational Structure</h3>
                        <p class="text-gray-500 text-sm">ทำความรู้จักกับ C&I และบทบาทสำคัญในองค์กร</p>
                    </div>

                    <div class="detail-card bg-gray-50 p-6 rounded-xl shadow-md hover:shadow-lg transition duration-300 cursor-pointer hover:ring-2 hover:ring-egat-blue" data-detail="core_work">
                        <div class="flex items-center justify-between mb-3">
                            <span class="text-4xl text-egat-blue">🛠️</span>
                        </div>
                        <h3 class="text-xl font-semibold text-egat-blue mb-1">Core C&I Functions</h3>
                        <p class="text-gray-500 text-sm">แยกประเภทงานควบคุมและงานเครื่องมือวัด</p>
                    </div>
                    
                    <div class="detail-card bg-gray-50 p-6 rounded-xl shadow-md hover:shadow-lg transition duration-300 cursor-pointer hover:ring-2 hover:ring-egat-blue" data-detail="system_overview">
                        <div class="flex items-center justify-between mb-3">
                            <span class="text-4xl text-egat-blue">⚙️</span>
                        </div>
                        <h3 class="text-xl font-semibold text-egat-blue mb-1">Control & Instrumentation Systems</h3>
                        <p class="text-gray-500 text-sm">ส่วนประกอบและเทคโนโลยีหลักที่ใช้งาน</p>
                    </div>
                    
                    <div class="detail-card bg-gray-50 p-6 rounded-xl shadow-md hover:shadow-lg transition duration-300 cursor-pointer hover:ring-2 hover:ring-egat-blue" data-detail="maintenance">
                        <div class="flex items-center justify-between mb-3">
                            <span class="text-4xl text-egat-blue">🔧</span>
                        </div>
                        <h3 class="text-xl font-semibold text-egat-blue mb-1">Maintenance and Repair</h3>
                        <p class="text-gray-500 text-sm">แนวทางการบำรุงรักษาและการสอบเทียบ</p>
                    </div>

                    <div class="detail-card bg-gray-50 p-6 rounded-xl shadow-md hover:shadow-lg transition duration-300 cursor-pointer hover:ring-2 hover:ring-egat-blue" data-detail="safety">
                        <div class="flex items-center justify-between mb-3">
                            <span class="text-4xl text-egat-blue">🛡️</span>
                        </div>
                        <h3 class="text-xl font-semibold text-egat-blue mb-1">Safety and Compliance</h3>
                        <p class="text-gray-500 text-sm">มาตรฐานความปลอดภัยและข้อบังคับที่เกี่ยวข้อง</p>
                    </div>

                    <div class="detail-card bg-gray-50 p-6 rounded-xl shadow-md hover:shadow-lg transition duration-300 cursor-pointer hover:ring-2 hover:ring-egat-blue" data-detail="future">
                        <div class="flex items-center justify-between mb-3">
                            <span class="text-4xl text-egat-blue">💡</span>
                        </div>
                        <h3 class="text-xl font-semibold text-egat-blue mb-1">Technology and Future</h3>
                        <p class="text-gray-500 text-sm">แนวโน้มการเปลี่ยนแปลงและเทคโนโลยีใหม่</p>
                    </div>

                </div>
            </div>
        </section>
        
        <section id="training" class="content-section hidden mb-16 opacity-0">
            <div class="max-w-5xl mx-auto p-8 rounded-xl shadow-2xl bg-white border border-gray-200">
                <div class="text-center">
                    <h2 class="text-3xl md:text-4xl font-extrabold text-egat-blue mb-2">
                        On the Job Training Resources
                    </h2>
                    <p class="text-lg text-gray-600 max-w-4xl mx-auto border-b border-egat-yellow pb-4 mb-8 text-center">
                        นี่คือแหล่งรวมความรู้และเอกสารสำหรับการฝึกอบรมในตำแหน่งงาน C&I
                    </p>
                    <p class="text-lg text-gray-600 max-w-4xl mx-auto">
                        โปรดเลือกหัวข้อย่อยด้านบน (Combined Cycle Power Plant หรือ Solar Power Plant) เพื่อดูรายละเอียด
                    </p>
                </div>
            </div>
        </section>

        <section id="combined_cycle" class="content-section hidden mb-16 opacity-0">
            <div class="max-w-5xl mx-auto p-8 rounded-xl shadow-2xl bg-white border border-gray-200">
                
                <div class="text-center">
                    <h2 class="text-3xl md:text-4xl font-extrabold text-egat-blue mb-2 text-center">
                        Combined Cycle Power Plant
                    </h2>
                    <p class="text-lg text-gray-600 max-w-4xl mx-auto border-b border-egat-yellow pb-4 mb-8 text-center">
                        โรงไฟฟ้าพลังความร้อนร่วมใช้เทคโนโลยีการผลิตไฟฟ้าแบบ 2 วัฏจักร (Cycle) เพื่อเพิ่มประสิทธิภาพในการผลิตไฟฟ้าสูงสุด
                    </p>
                </div>

                <div class="mb-10 p-6 bg-egat-blue/5 rounded-lg border border-egat-blue/10 shadow-md">
                    <h3 class="text-2xl font-bold text-egat-blue mb-3 text-center">Fundamental Principles and Operating Cycles</h3>
                    <p class="text-gray-700 mb-4 text-center">Combined Cycle คือการรวม วัฏจักรเบรย์ตัน (Brayton Cycle) จากกังหันก๊าซ เข้ากับ วัฏจักรแรงคิน (Rankine Cycle) จากกังหันไอน้ำ เพื่อนำความร้อนเหลือทิ้งมาใช้ซ้ำ</p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-4">
                        <div class="detail-card bg-white p-6 rounded-lg shadow-lg border border-gray-100 cursor-pointer hover:shadow-xl transition duration-300 hover:ring-2 hover:ring-egat-blue" data-detail="cc_brayton_cycle">
                            <h4 class="font-semibold text-xl text-gray-800 mb-2 flex items-center">
                                <span class="text-egat-blue text-2xl mr-2 font-extrabold">1.</span> Brayton Cycle (Gas Turbine)
                            </h4>
                            <p class="text-sm text-gray-600 mb-2">เผาไหม้ก๊าซเพื่อขับกังหัน (Gas Turbine) ผลิตไฟฟ้ารอบแรก</p>
                            <p class="text-sm text-egat-blue font-medium">คลิกเพื่อดูบทบาท C&I ในวัฏจักรเบรย์ตัน...</p>
                        </div>

                        <div class="detail-card bg-white p-6 rounded-lg shadow-lg border border-gray-100 cursor-pointer hover:shadow-xl transition duration-300 hover:ring-2 hover:ring-egat-blue" data-detail="cc_rankine_cycle">
                            <h4 class="font-semibold text-xl text-gray-800 mb-2 flex items-center">
                                <span class="text-egat-blue text-2xl mr-2 font-extrabold">2.</span> Rankine Cycle (Steam Turbine)
                            </h4>
                            <p class="text-sm text-gray-600 mb-2">นำความร้อนจากไอเสียมาผลิตไอน้ำ (HRSG) ขับกังหันไอน้ำ</p>
                            <p class="text-sm text-egat-blue font-medium">คลิกเพื่อดูบทบาท C&I ในวัฏจักรแรงคิน...</p>
                        </div>
                    </div>
                </div>

                <h3 class="text-2xl font-bold text-egat-blue mb-4 text-center border-b border-gray-200 pb-2">In-Depth Details (Click for C&I Role)</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <!-- Uniformity: Consistent card padding and hover effects -->
                    <div class="detail-card bg-gray-50 p-6 rounded-xl shadow-md hover:shadow-lg transition duration-300 cursor-pointer hover:ring-2 hover:ring-egat-blue" data-detail="cc_gasturbine">
                        <div class="flex items-center justify-between mb-3">
                            <span class="text-4xl text-egat-blue">🔥</span>
                        </div>
                        <h3 class="text-xl font-semibold text-egat-blue mb-1">Gas Turbine (GT) and Combustion</h3>
                        <p class="text-gray-500 text-sm">การควบคุมอุณหภูมิ, เชื้อเพลิง, และระบบป้องกันอันตราย</p>
                    </div>

                    <div class="detail-card bg-gray-50 p-6 rounded-xl shadow-md hover:shadow-lg transition duration-300 cursor-pointer hover:ring-2 hover:ring-egat-blue" data-detail="cc_hrsg">
                        <div class="flex items-center justify-between mb-3">
                            <span class="text-4xl text-egat-blue">♨️</span>
                        </div>
                        <h3 class="text-xl font-semibold text-egat-blue mb-1">HRSG (Heat Recovery Steam Generator)</h3>
                        <p class="text-gray-500 text-sm">การควบคุมแรงดัน, อุณหภูมิไอน้ำ, และระดับน้ำ</p>
                    </div>

                    <div class="detail-card bg-gray-50 p-6 rounded-xl shadow-md hover:shadow-lg transition duration-300 cursor-pointer hover:ring-2 hover:ring-egat-blue" data-detail="cc_steamturbine">
                        <div class="flex items-center justify-between mb-3">
                            <span class="text-4xl text-egat-blue">💧</span>
                        </div>
                        <h3 class="text-xl font-semibold text-egat-blue mb-1">Steam Turbine (ST) and Balance of Plant (BOP)</h3>
                        <p class="text-gray-500 text-sm">การควบคุมการทำงานของ ST, คอนเดนเซอร์, และปั๊ม</p>
                    </div>

                </div>
                
                <div class="mt-12">
                    <h3 class="text-2xl font-bold text-egat-blue mb-4 text-center border-b border-gray-200 pb-2">Central Control Systems</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 text-center">
                        
                        <div class="detail-card p-4 rounded-lg bg-gray-50 border border-egat-blue/20 cursor-pointer hover:shadow-md transition duration-300 hover:ring-2 hover:ring-egat-blue" data-detail="cc_dcs">
                            <span class="text-3xl text-egat-blue block mb-1">🖥️</span>
                            <h4 class="font-semibold text-lg text-gray-800">DCS (Distributed Control System)</h4>
                            <p class="text-sm text-gray-600">ควบคุมรวม, แสดงผล, และบริหารจัดการการผลิต</p>
                        </div>
                        
                        <div class="detail-card p-4 rounded-lg bg-gray-50 border border-egat-blue/20 cursor-pointer hover:shadow-md transition duration-300 hover:ring-2 hover:ring-egat-blue" data-detail="cc_bms">
                            <span class="text-3xl text-egat-blue block mb-1">🚨</span>
                            <h4 class="font-semibold text-lg text-gray-800">BMS (Burner Management System)</h4>
                            <p class="text-sm text-gray-600">จัดการการจุดระเบิดและการดับฉุกเฉิน</p>
                        </div>
                        
                        <div class="detail-card p-4 rounded-lg bg-gray-50 border border-egat-blue/20 cursor-pointer hover:shadow-md transition duration-300 hover:ring-2 hover:ring-egat-blue" data-detail="cc_vibration">
                            <span class="text-3xl text-egat-blue block mb-1">⚙️</span>
                            <h4 class="font-semibold text-lg text-gray-800">Vibration Monitoring System</h4>
                            <p class="text-sm text-gray-600">ตรวจวัดและป้องกันความเสียหายจากแรงสั่นสะเทือน</p>
                        </div>
                        
                        <div class="detail-card p-4 rounded-lg bg-gray-50 border border-egat-blue/20 cursor-pointer hover:shadow-md transition duration-300 hover:ring-2 hover:ring-egat-blue" data-detail="cc_cems">
                            <span class="text-3xl text-egat-blue block mb-1">🧪</span>
                            <h4 class="font-semibold text-lg text-gray-800">CEMS (Continuous Emission Monitoring)</h4>
                            <p class="text-sm text-gray-600">ตรวจสอบมลพิษจากปล่องอย่างต่อเนื่อง</p>
                        </div>
                        
                    </div>
                </div>

            </div>
        </section>

        <section id="solar_power" class="content-section hidden mb-16 opacity-0">
            <div class="max-w-5xl mx-auto p-8 rounded-xl shadow-2xl bg-white border border-gray-200">
                <div class="text-center">
                    <h2 class="text-3xl md:text-4xl font-extrabold text-egat-blue mb-2"> 
                        Solar Power Plant
                    </h2>
                    <p class="text-lg text-gray-600 max-w-4xl mx-auto border-b border-egat-yellow pb-4 mb-8 text-center">
                        หน้าที่ของ C&I ในการผลิตและการเชื่อมต่อพลังงานแสงอาทิตย์เข้ากับระบบโครงข่ายไฟฟ้า
                    </p>
                </div>

                <div class="mb-10 p-6 bg-egat-yellow/5 rounded-lg border border-egat-yellow/10 shadow-md">
                    <h3 class="text-2xl font-bold text-egat-blue mb-3 text-center">Fundamental Process and Energy Conversion</h3>
                    <p class="text-gray-700 mb-4 text-center">การผลิตไฟฟ้าพลังงานแสงอาทิตย์ (Solar PV) เกี่ยวข้องกับการแปลงแสงอาทิตย์เป็นไฟฟ้าโดยตรง ตามด้วยการปรับสภาพและประสานเข้ากับระบบโครงข่ายไฟฟ้า</p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-4">
                        <div class="detail-card bg-white p-6 rounded-lg shadow-lg border border-gray-100 cursor-pointer hover:shadow-xl transition duration-300 hover:ring-2 hover:ring-egat-yellow" data-detail="sp_dc_generation">
                            <h4 class="font-semibold text-xl text-gray-800 mb-2 flex items-center">
                                <span class="text-egat-blue text-2xl mr-2 font-extrabold">1.</span> DC Generation (PV Array)
                            </h4>
                            <p class="text-sm text-gray-600 mb-2">แผงโซลาร์เซลล์จะรับโฟตอนและสร้างกำลังไฟฟ้ากระแสตรง (DC)</p>
                            <p class="text-sm text-egat-blue font-medium">คลิกเพื่อดูบทบาท C&I ในชุดแผงเซลล์แสงอาทิตย์...</p>
                        </div>

                        <div class="detail-card bg-white p-6 rounded-lg shadow-lg border border-gray-100 cursor-pointer hover:shadow-xl transition duration-300 hover:ring-2 hover:ring-egat-yellow" data-detail="sp_ac_conversion">
                            <h4 class="font-semibold text-xl text-gray-800 mb-2 flex items-center">
                                <span class="text-egat-blue text-2xl mr-2 font-extrabold">2.</span> AC Conversion (Inverter)
                            </h4>
                            <p class="text-sm text-gray-600 mb-2">กำลังไฟฟ้ากระแสตรง (DC) จะถูกแปลงเป็นไฟฟ้ากระแสสลับ (AC) และซิงโครไนซ์เข้ากับระบบโครงข่ายไฟฟ้า</p>
                            <p class="text-sm text-egat-blue font-medium">คลิกเพื่อดูบทบาท C&I ในอินเวอร์เตอร์...</p>
                        </div>
                    </div>
                </div>

                <h3 class="text-2xl font-bold text-egat-blue mb-4 text-center border-b border-gray-200 pb-2">Key C&I Components (Click for Details)</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <!-- Uniformity: Consistent card padding and hover effects -->
                    <div class="detail-card bg-gray-50 p-6 rounded-xl shadow-md hover:shadow-lg transition duration-300 cursor-pointer hover:ring-2 hover:ring-egat-blue" data-detail="sp_inverters">
                        <div class="flex items-center justify-between mb-3">
                            <span class="text-4xl text-egat-blue">⚡</span>
                        </div>
                        <h3 class="text-xl font-semibold text-egat-blue mb-1">Inverter and MPPT Control</h3>
                        <p class="text-gray-500 text-sm">การควบคุมการแปลงพลังงานและการติดตามจุดกำลังไฟฟ้าสูงสุด</p>
                    </div>

                    <div class="detail-card bg-gray-50 p-6 rounded-xl shadow-md hover:shadow-lg transition duration-300 cursor-pointer hover:ring-2 hover:ring-egat-blue" data-detail="sp_weather">
                        <div class="flex items-center justify-between mb-3">
                            <span class="text-4xl text-egat-blue">☁️</span>
                        </div>
                        <h3 class="text-xl font-semibold text-egat-blue mb-1">Weather Monitoring Station</h3>
                        <p class="text-gray-500 text-sm">การวัดค่าความเข้มแสง อุณหภูมิ และความเร็วลม</p>
                    </div>

                    <div class="detail-card bg-gray-50 p-6 rounded-xl shadow-md hover:shadow-lg transition duration-300 cursor-pointer hover:ring-2 hover:ring-egat-blue" data-detail="sp_protection">
                        <div class="flex items-center justify-between mb-3">
                            <span class="text-4xl text-egat-blue">🛡️</span>
                        </div>
                        <h3 class="text-xl font-semibold text-egat-blue mb-1">Safety and Grid Protection</h3>
                        <p class="text-gray-500 text-sm">ระบบป้องกันการลัดวงจรและการต่อเข้าระบบโครงข่าย</p>
                    </div>

                </div>
                
                <div class="mt-12">
                    <h3 class="text-2xl font-bold text-egat-blue mb-4 text-center border-b border-gray-200 pb-2">Control and Monitoring Systems</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 text-center">
                        
                        <div class="detail-card p-4 rounded-lg bg-gray-50 border border-egat-blue/20 cursor-pointer hover:shadow-md transition duration-300 hover:ring-2 hover:ring-egat-blue" data-detail="sp_scada">
                            <span class="text-3xl text-egat-blue block mb-1">🖥️</span>
                            <h4 class="font-semibold text-lg text-gray-800">SCADA/PPC (Plant Controller)</h4>
                            <p class="text-sm text-gray-600">ควบคุมกำลังไฟฟ้าส่งออกและบริหารจัดการโรงไฟฟ้า</p>
                        </div>
                        
                        <div class="detail-card p-4 rounded-lg bg-gray-50 border border-egat-blue/20 cursor-pointer hover:shadow-md transition duration-300 hover:ring-2 hover:ring-egat-blue" data-detail="sp_tracker">
                            <span class="text-3xl text-egat-blue block mb-1">⚙️</span>
                            <h4 class="font-semibold text-lg text-gray-800">Tracking System C&I</h4>
                            <p class="text-sm text-gray-600">การควบคุมมอเตอร์และเซ็นเซอร์ติดตามดวงอาทิตย์</p>
                        </div>
                        
                        <div class="detail-card p-4 rounded-lg bg-gray-50 border border-egat-blue/20 cursor-pointer hover:shadow-md transition duration-300 hover:ring-2 hover:ring-egat-blue" data-detail="sp_dccomps">
                            <span class="text-3xl text-egat-blue block mb-1">🔌</span>
                            <h4 class="font-semibold text-lg text-gray-800">DC Component Monitoring</h4>
                            <p class="text-sm text-gray-600">การวัดกระแส/แรงดัน DC และการตรวจสอบ String/Array</p>
                        </div>
                        
                        <div class="detail-card p-4 rounded-lg bg-gray-50 border border-egat-blue/20 cursor-pointer hover:shadow-md transition duration-300 hover:ring-2 hover:ring-egat-blue" data-detail="sp_ir_temp">
                            <span class="text-3xl text-egat-blue block mb-1">🌡️</span>
                            <h4 class="font-semibold text-lg text-gray-800">IR Temperature Sensing</h4>
                            <p class="text-sm text-gray-600">การเฝ้าระวังความร้อนสูงในจุดเชื่อมต่อและแผง</p>
                        </div>
                        
                    </div>
                </div>
            </div>
        </section>


    </main>
    
    <!-- Optimized Modal Structure for cleaner transition control -->
    <div id="modal" class="hidden fixed inset-0 z-40">
        <div id="modal-backdrop" class="fixed inset-0 bg-gray-900 modal-backdrop-transition opacity-0"></div>

        <div id="modal-content-box" class="fixed inset-0 flex items-center justify-center p-4 modal-content-transition scale-95 opacity-0">
            <div class="modal-content bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto relative p-8">
                
                <h3 id="modal-title" class="text-3xl font-bold text-egat-blue mb-4 border-b pb-2"></h3>
                
                <div id="modal-body" class="text-gray-700 space-y-4">
                </div>
                
                <button onclick="closeModal()" class="absolute top-4 right-4 text-gray-400 hover:text-gray-800 transition duration-300">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6L6 18"/><path d="M6 6l12 12"/></svg>
                </button>

            </div>
        </div>
    </div>


    <div class="hidden">
        <!-- DETAIL CONTENT (Kept intact, removed duplicate style in JS) -->
        <div id="detail-content-intro">
            <h3 class="text-2xl font-bold text-egat-blue mb-4">Introduction and Organizational Structure</h3>
            <span id="detail-topic-intro" class="hidden">Organizational Structure and Key Responsibilities of C&I Team in Power Plant</span>
            <section class="mb-6">
                <h4 class="text-lg font-semibold text-gray-700 mt-4 mb-2">Background and Evolution</h4>
                <p class="text-gray-600">งาน C&I เริ่มต้นขึ้นพร้อมกับการพัฒนาโรงไฟฟ้าของ กฟผ. โดยมีวิวัฒนาการจากการควบคุมแบบอะนาล็อกไปสู่ระบบดิจิทัลที่ซับซ้อนในปัจจุบัน</p>
            </section>

            <section class="mb-6">
                <h4 class="text-lg font-semibold text-gray-700 mt-4 mb-2">Mission and Significance</h4>
                <p class="text-gray-600">มุ่งเน้นการบำรุงรักษาระบบควบคุมและเครื่องมือวัดให้อยู่ในสภาพพร้อมใช้งานสูงสุด เพื่อสนับสนุนการผลิตไฟฟ้าที่มั่นคงและมีประสิทธิภาพ</p>
            </section>

            <section class="mb-6">
                <h4 class="text-lg font-semibold text-gray-700 mt-4 mb-2">C&I Team Structure</h4>
                <p class="text-gray-600">แบ่งออกเป็นหน่วยงานย่อยตามลักษณะของระบบ เช่น ระบบควบคุมหลัก (DCS), ระบบความปลอดภัย, และงานสอบเทียบเครื่องมือวัด</p>
            </section>

            <section class="mb-6">
                <h4 class="text-lg font-semibold text-gray-700 mt-4 mb-2">Key Team Responsibilities</h4>
                <ul class="list-disc pl-5 space-y-1 text-gray-600">
                    <li>วางแผนและดำเนินการบำรุงรักษาเชิงป้องกัน (PM)</li>
                    <li>วิเคราะห์และแก้ไขปัญหาที่เกิดขึ้นกับระบบควบคุม</li>
                    <li>บริหารจัดการอะไหล่และเอกสารทางเทคนิค</li>
                </ul>
            </section>
        </div>

        <div id="detail-content-core_work">
            <h3 class="text-2xl font-bold text-egat-blue mb-4">Core C&I Functions</h3>
             <span id="detail-topic-core_work" class="hidden">DCS and PLC maintenance in power generation.</span>
            <section class="mb-6">
                <h4 class="text-lg font-semibold text-gray-700 mt-4 mb-2">Primary Control Systems (DCS/PLC)</h4>
                <p class="text-gray-600">การดูแลรักษาและปรับปรุงระบบควบคุมอัตโนมัติ เช่น DCS (Distributed Control System) และ PLC (Programmable Logic Controller) เพื่อควบคุมกระบวนการผลิตไฟฟ้า</p>
            </section>

            <section class="mb-6">
                <h4 class="text-lg font-semibold text-gray-700 mt-4 mb-2">Instrumentation and Sensors</h4>
                <p class="text-gray-600">การติดตั้ง บำรุงรักษา และสอบเทียบเครื่องมือวัดต่างๆ เช่น เครื่องวัดอุณหภูมิ ความดัน อัตราการไหล และระดับ เพื่อให้การวัดค่ามีความแม่นยำ</p>
            </section>

            <section class="mb-6">
                <h4 class="text-lg font-semibold text-gray-700 mt-4 mb-2">Specialized Work and Technology</h4>
                <p class="text-gray-600">รวมถึงงานที่เกี่ยวข้องกับระบบความปลอดภัย (Safety Instrumented Systems - SIS), ระบบตรวจจับเพลิงไหม้ (Fire and Gas), และระบบควบคุมกังหัน (Turbine Control Systems)</p>
            </section>

            <section class="mb-6">
                <h4 class="text-lg font-semibold text-gray-700 mt-4 mb-2">Technical Documentation Management</h4>
                <p class="text-gray-600">การจัดทำ จัดเก็บ และปรับปรุงแบบแปลน (Drawings), คู่มือ (Manuals), และประวัติการซ่อมบำรุง (Maintenance Records) เพื่อให้พร้อมสำหรับการอ้างอิงและตรวจสอบ</p>
            </section>
        </div>

        <div id="detail-content-system_overview">
            <h3 class="text-2xl font-bold text-egat-blue mb-4">Control and Instrumentation Systems</h3>
             <span id="detail-topic-system_overview" class="hidden">Power Plant Control Systems (DCS/PLC, Sensors, and Safety Systems)</span>
            <section class="mb-6">
                <h4 class="text-lg font-semibold text-gray-700 mt-4 mb-2">Primary Control Systems (DCS/PLC)</h4>
                <p class="text-gray-600">เป็นหัวใจสำคัญในการสั่งการและควบคุมการทำงานของอุปกรณ์ในโรงไฟฟ้า โดยมีสถาปัตยกรรมแบบกระจายศูนย์ (Distributed Architecture)</p>
            </section>

            <section class="mb-6">
                <h4 class="text-lg font-semibold text-gray-700 mt-4 mb-2">Sensors and Transducers</h4>
                <p class="text-gray-600">อุปกรณ์ที่แปลงค่าทางกายภาพ (เช่น ความร้อน, แรงดัน) ให้เป็นสัญญาณไฟฟ้า เพื่อส่งไปยังระบบควบคุม</p>
            </section>

            <section class="mb-6">
                <h4 class="text-lg font-semibold text-gray-700 mt-4 mb-2">Safety Systems</h4>
                <p class="text-gray-600">ระบบที่ออกแบบมาเพื่อป้องกันความเสียหายต่ออุปกรณ์ บุคลากร และสิ่งแวดล้อม เช่น ระบบ ESD (Emergency Shutdown)</p>
            </section>
        </div>
        
        <div id="detail-content-maintenance">
            <h3 class="text-2xl font-bold text-egat-blue mb-4">Maintenance and Repair</h3>
            <span id="detail-topic-maintenance" class="hidden">Preventive and Corrective Maintenance for C&I systems including calibration standards</span>
            <section class="mb-6">
                <h4 class="text-lg font-semibold text-gray-700 mt-4 mb-2">Preventive Maintenance (PM)</h4>
                <p class="text-gray-600">การดำเนินการตามแผนเพื่อป้องกันความล้มเหลวของอุปกรณ์ เช่น การเปลี่ยนแบตเตอรี่, การทำความสะอาดตู้ควบคุม, และการตรวจสอบสายสัญญาณ</p>
            </section>

            <section class="mb-6">
                <h4 class="text-lg font-semibold text-gray-700 mt-4 mb-2">Corrective Maintenance (CM)</h4>
                <p class="text-gray-600">การซ่อมแซมทันทีเมื่อเกิดความผิดปกติหรือความล้มเหลวของระบบ เพื่อให้ระบบกลับมาทำงานได้ตามปกติ</p>
            </section>

            <section class="mb-6">
                <h4 class="text-lg font-semibold text-gray-700 mt-4 mb-2">Calibration and Standards</h4>
                <p class="text-gray-600">การสอบเทียบเครื่องมือวัดตามมาตรฐานสากล (เช่น ISO/IEC 17025) และการเก็บบันทึกประวัติการสอบเทียบอย่างเป็นระบบ</p>
            </section>

            <section class="mb-6">
                <h4 class="text-lg font-semibold text-gray-700 mt-4 mb-2">Spares and Tool Management</h4>
                <p class="text-gray-600">การสำรองอะไหล่สำคัญ (Critical Spares) อย่างเหมาะสม และการดูแลรักษาเครื่องมือสอบเทียบและเครื่องมือเฉพาะทางให้อยู่ในสภาพพร้อมใช้งาน</p>
            </section>
        </div>

        <div id="detail-content-safety">
            <h3 class="text-2xl font-bold text-egat-blue mb-4">Safety and Compliance</h3>
            <span id="detail-topic-safety" class="hidden">Safety standards, compliance, and risk management for C&I systems (e.g., IEC 61511)</span>
            <section class="mb-6">
                <h4 class="text-lg font-semibold text-gray-700 mt-4 mb-2">Standards and Regulations</h4>
                <p class="text-gray-600">การปฏิบัติตามมาตรฐาน IEC 61511 (Safety Instrumented Systems) และข้อกำหนดอื่นๆ ที่เกี่ยวข้องกับการทำงานในพื้นที่เสี่ยง (Hazardous Areas)</p>
            </section>

            <section class="mb-6">
                <h4 class="text-lg font-semibold text-gray-700 mt-4 mb-2">Training and Certification</h4>
                <p class="text-gray-600">บุคลากร C&I ต้องได้รับการฝึกอบรมเฉพาะทางด้านเทคนิค ความปลอดภัย และการทำงานกับระบบไฟฟ้า/ควบคุมแรงดันสูง</p>
            </section>

            <section class="mb-6">
                <h4 class="text-lg font-semibold text-gray-700 mt-4 mb-2">C&I Risk Management</h4>
                <p class="text-gray-600">การประเมินความเสี่ยงและวางแผนบรรเทาความเสี่ยงที่เกี่ยวข้องกับการทำงานผิดพลาดของระบบควบคุมซึ่งอาจส่งผลกระทบต่อการผลิตและความปลอดภัย</p>
            </section>
        </div>
        
        <div id="detail-content-future">
            <h3 class="text-2xl font-bold text-egat-blue mb-4">Technology and Future</h3>
            <span id="detail-topic-future" class="hidden">Digital Transformation, Cybersecurity, and future trends in C&I maintenance</span>
            <section class="mb-6">
                <h4 class="text-lg font-semibold text-gray-700 mt-4 mb-2">Digital Transformation and Industry 4.0</h4>
                <p class="text-gray-600">การนำเทคโนโลยี IoT, Cloud Computing และ AI มาใช้ในการวิเคราะห์ข้อมูลการทำงานของ C&I เพื่อการบำรุงรักษาเชิงคาดการณ์ (Predictive Maintenance)</p>
            </section>

            <section class="mb-6">
                <h4 class="text-lg font-semibold text-gray-700 mt-4 mb-2">Cybersecurity</h4>
                <p class="text-gray-600">การป้องกันระบบควบคุมอุตสาหกรรม (ICS) จากภัยคุกคามทางไซเบอร์ ซึ่งเป็นสิ่งสำคัญอย่างยิ่งในยุคดิจิทัล</p>
            </section>

            <section class="mb-6">
                <h4 class="text-lg font-semibold text-gray-700 mt-4 mb-2">Future Trends</h4>
                <p class="text-gray-600">การเปลี่ยนไปใช้เครื่องมือวัดไร้สาย (Wireless Instrumentation) และการบูรณาการระบบควบคุมจากผู้ผลิตที่หลากหลาย (Vendor Neutral Systems)</p>
            </section>
        </div>

        <div id="detail-content-cc_brayton_cycle">
            <h3 class="text-2xl font-bold text-egat-blue mb-4">C&I Role in Brayton Cycle (Gas Turbine)</h3>
            <section class="mb-6">
                <p class="text-gray-600">ควบคุมอัตราส่วนเชื้อเพลิงต่ออากาศ (Air/Fuel Ratio) และการทำงานของวาล์วเชื้อเพลิงเพื่อให้การเผาไหม้สมบูรณ์และลดมลพิษ (NOx)</p>
            </section>
            <section class="mb-6">
                <p class="text-gray-600">เฝ้าระวังอุณหภูมิก๊าซไอเสีย (Exhaust Gas Temperature - EGT) และการสั่นสะเทือนของกังหันเพื่อป้องกันความเสียหาย</p>
            </section>
        </div>

        <div id="detail-content-cc_rankine_cycle">
            <h3 class="text-2xl font-bold text-egat-blue mb-4">C&I Role in Rankine Cycle (Steam Turbine)</h3>
            <section class="mb-6">
                <p class="text-gray-600">ควบคุมระดับน้ำในหม้อไอน้ำ (Drum Level Control), อุณหภูมิไอน้ำ (Superheater Temperature Control), และแรงดันไอน้ำ</p>
            </section>
            <section class="mb-6">
                <p class="text-gray-600">ดูแลระบบป้องกันการเร่งความเร็วเกิน (Overspeed Protection), ระบบวาล์วไอน้ำเข้า (Stop & Governor Valves), และระบบแบริ่ง</p>
            </section>
        </div>
        
        <div id="detail-content-cc_gasturbine">
            <h3 class="text-2xl font-bold text-egat-blue mb-4">Gas Turbine (GT) and Combustion</h3>
            <span id="detail-topic-cc_gasturbine" class="hidden">Gas Turbine and Combustion control systems in combined cycle power plants</span>
            <section class="mb-6">
                <h4 class="text-lg font-semibold text-gray-700 mt-4 mb-2">GT Principles and Cycle</h4>
                <p class="text-gray-600">อากาศถูกอัดโดยคอมเพรสเซอร์ (Compressor) ผสมกับเชื้อเพลิงในห้องเผาไหม้ (Combustion Chamber) และก๊าซร้อนที่ได้จะขับเคลื่อนกังหัน (Turbine) เพื่อผลิตไฟฟ้าตามวัฏจักร Brayton การควบคุมอุณหภูมิที่เข้าสู่กังหันเป็นสิ่งสำคัญที่สุด</p>
            </section>
            <section class="mb-6">
                <h4 class="text-lg font-semibold text-gray-700 mt-4 mb-2">C&I Functions</h4>
                <p class="text-gray-600">ติดตั้งและบำรุงรักษา: Flame Detectors, Thermocouples/RTDs, Pressure Transmitters, Flow Meters สำหรับเชื้อเพลิง, และระบบป้องกันไฟไหม้</p>
            </section>
        </div>

        <div id="detail-content-cc_hrsg">
            <h3 class="text-2xl font-bold text-egat-blue mb-4">HRSG (Heat Recovery Steam Generator)</h3>
            <span id="detail-topic-cc_hrsg" class="hidden">Control and Instrumentation for Heat Recovery Steam Generator (HRSG)</span>
            <section class="mb-6">
                <h4 class="text-lg font-semibold text-gray-700 mt-4 mb-2">Process Overview</h4>
                <p class="text-gray-600">HRSG ทำหน้าที่นำความร้อนทิ้งจากไอเสีย GT มาผลิตไอน้ำ แรงดันสูง กลาง และต่ำ เพื่อขับเคลื่อนกังหันไอน้ำ</p>
            </section>
            <section class="mb-6">
                <h4 class="text-lg font-semibold text-gray-700 mt-4 mb-2">C&I Functions</h4>
                <p class="text-gray-600">การควบคุม: Feedwater Control (ควบคุมระดับน้ำในดรัม), Attemperator/Desuperheater Control (ควบคุมอุณหภูมิไอน้ำออก), และติดตั้ง Safety Valves</p>
            </section>
        </div>
        
        <div id="detail-content-cc_steamturbine">
            <h3 class="text-2xl font-bold text-egat-blue mb-4">Steam Turbine (ST) and BOP</h3>
            <span id="detail-topic-cc_steamturbine" class="hidden">Steam Turbine and Balance of Plant control systems in combined cycle power plants</span>
            <section class="mb-6">
                <h4 class="text-lg font-semibold text-gray-700 mt-4 mb-2">Steam Turbine Control</h4>
                <p class="text-gray-600">ระบบควบคุมความเร็ว (Governor) และระบบป้องกันอันตรายจากการเร่งความเร็วเกิน (Overspeed Trip System) ซึ่งเป็นงาน C&I ที่มีความสำคัญสูงสุด</p>
            </section>
            <section class="mb-6">
                <h4 class="text-lg font-semibold text-gray-700 mt-4 mb-2">BOP (Balance of Plant)</h4>
                <p class="text-gray-600">ควบคุมและเฝ้าระวังส่วนประกอบเสริม เช่น Condenser (วัดสูญญากาศและระดับน้ำ), Cooling Water Pumps, และ Demineralizer Plant</p>
            </section>
        </div>

        <div id="detail-content-cc_dcs">
            <h3 class="text-2xl font-bold text-egat-blue mb-4">DCS (Distributed Control System)</h3>
            <span id="detail-topic-cc_dcs" class="hidden">DCS in Combined Cycle Power Plant.</span>
            <section class="mb-6">
                <p class="text-gray-600">เป็นระบบควบคุมหลักที่ใช้ในการสั่งการ, ประมวลผล, และแสดงผลการทำงานทั้งหมดของโรงไฟฟ้า โดยมีสถาปัตยกรรมแบบกระจายศูนย์ (Distributed Architecture)</p>
            </section>
        </div>

        <div id="detail-content-cc_bms">
            <h3 class="text-2xl font-bold text-egat-blue mb-4">BMS (Burner Management System)</h3>
            <span id="detail-topic-cc_bms" class="hidden">BMS in Combined Cycle Power Plant.</span>
            <section class="mb-6">
                <p class="text-gray-600">ระบบความปลอดภัยที่รับผิดชอบในการจุดระเบิดและการดับฉุกเฉินของเตาเผา (Combustor) ใน GT หรือ Burner ใน Auxiliary Boiler ป้องกันการเกิดระเบิด</p>
            </section>
        </div>

        <div id="detail-content-cc_vibration">
            <h3 class="text-2xl font-bold text-egat-blue mb-4">Vibration Monitoring System</h3>
            <span id="detail-topic-cc_vibration" class="hidden">Vibration Monitoring System in Combined Cycle Power Plant</span>
            <section class="mb-6">
                <p class="text-gray-600">ติดตั้ง Probes และ Sensors เพื่อตรวจวัดการสั่นสะเทือนของแบริ่งและเพลาในกังหัน GT และ ST เพื่อประเมินสภาพเครื่องจักรแบบ Real-time</p>
            </section>
        </div>

        <div id="detail-content-cc_cems">
            <h3 class="text-2xl font-bold text-egat-blue mb-4">CEMS (Continuous Emission Monitoring)</h3>
            <span id="detail-topic-cc_cems" class="hidden">CEMS in Combined Cycle Power Plant.</span>
            <section class="mb-6">
                <p class="text-gray-600">ระบบวิเคราะห์ทางเคมีที่ติดตั้งที่ปล่องระบาย เพื่อวัดปริมาณมลพิษ (เช่น NOx, CO, SO2) อย่างต่อเนื่อง เพื่อให้เป็นไปตามข้อกำหนดด้านสิ่งแวดล้อม</p>
            </section>
        </div>

        <div id="detail-content-sp_dc_generation">
            <h3 class="text-2xl font-bold text-egat-blue mb-4">C&I Role in DC Generation (PV Array)</h3>
            <section class="mb-6">
                <p class="text-gray-600">การวัดกระแสและแรงดันไฟฟ้ากระแสตรง (DC) ในระดับ String และ Array เพื่อการตรวจสอบประสิทธิภาพ (Performance Monitoring) และการตรวจจับความผิดปกติ เช่น Hot Spots</p>
            </section>
        </div>

        <div id="detail-content-sp_ac_conversion">
            <h3 class="text-2xl font-bold text-egat-blue mb-4">C&I Role in AC Conversion (Inverter)</h3>
            <section class="mb-6">
                <p class="text-gray-600">การควบคุม Inverter ให้แปลง DC เป็น AC ด้วยคุณภาพสูงสุด การควบคุมกำลังไฟฟ้าส่งออก (Active/Reactive Power) และการซิงโครไนซ์กับระบบโครงข่าย</p>
            </section>
        </div>

        <div id="detail-content-sp_inverters">
            <h3 class="text-2xl font-bold text-egat-blue mb-4">Inverter and MPPT Control</h3>
            <section class="mb-6">
                <p class="text-gray-600">MPPT (Maximum Power Point Tracking) คือฟังก์ชันการควบคุมที่ทำให้แผงโซลาร์เซลล์ผลิตกำลังไฟฟ้าได้สูงสุดภายใต้สภาพแสงที่เปลี่ยนแปลง ซึ่งเป็นบทบาทสำคัญของ Inverter</p>
            </section>
        </div>

        <div id="detail-content-sp_weather">
            <h3 class="text-2xl font-bold text-egat-blue mb-4">Weather Monitoring Station</h3>
            <section class="mb-6">
                <p class="text-gray-600">ติดตั้ง Pyranometer (วัดความเข้มแสง), Thermocouples (วัดอุณหภูมิแผง/อากาศ), และ Anemometer (วัดความเร็วลม) เพื่อนำข้อมูลมาคำนวณ Performance Ratio</p>
            </section>
        </div>

        <div id="detail-content-sp_protection">
            <h3 class="text-2xl font-bold text-egat-blue mb-4">Safety and Grid Protection</h3>
            <section class="mb-6">
                <p class="text-gray-600">ระบบป้องกันสำคัญ เช่น Ground Fault Detection, Anti-Islanding Protection (ป้องกันการจ่ายไฟเข้าโครงข่ายเมื่อโครงข่ายล้มเหลว), และ Surge Protection Devices</p>
            </section>
        </div>

        <div id="detail-content-sp_scada">
            <h3 class="text-2xl font-bold text-egat-blue mb-4">SCADA/PPC (Plant Controller)</h3>
            <section class="mb-6">
                <p class="text-gray-600">ระบบ SCADA ใช้ในการควบคุมและเฝ้าระวังโรงไฟฟ้าทั้งหมด ส่วน PPC (Power Plant Controller) ใช้ในการควบคุมกำลังไฟฟ้าส่งออกตามคำสั่งของผู้ควบคุมระบบโครงข่าย (System Operator)</p>
            </section>
        </div>
        
        <div id="detail-content-sp_tracker">
            <h3 class="text-2xl font-bold text-egat-blue mb-4">Tracking System C&I</h3>
            <section class="mb-6">
                <p class="text-gray-600">ในกรณีที่โรงไฟฟ้าใช้ระบบติดตามดวงอาทิตย์ (Tracker) งาน C&I คือการดูแลมอเตอร์, Limit Switches, และระบบควบคุมเพื่อให้แผงเซลล์หันเข้าหาดวงอาทิตย์อย่างแม่นยำ</p>
            </section>
        </div>

        <div id="detail-content-sp_dccomps">
            <h3 class="text-2xl font-bold text-egat-blue mb-4">DC Component Monitoring</h3>
            <section class="mb-6">
                <p class="text-gray-600">การวัดและบันทึกข้อมูล DC ในแต่ละ String และ Combiner Box เพื่อวิเคราะห์หา String ที่มีประสิทธิภาพต่ำกว่าปกติ (String Mismatch)</p>
            </section>
        </div>

        <div id="detail-content-sp_ir_temp">
            <h3 class="text-2xl font-bold text-egat-blue mb-4">IR Temperature Sensing</h3>
            <section class="mb-6">
                <p class="text-gray-600">การใช้กล้องถ่ายภาพความร้อน (Infrared Camera) หรือเซ็นเซอร์วัดอุณหภูมิแบบไม่สัมผัสเพื่อตรวจจับความผิดปกติที่เกิดจากความร้อนสูง (เช่น Hot Spots) บนแผงเซลล์หรือจุดเชื่อมต่อ</p>
            </section>
        </div>

    </div>

    <script>
        // Data for modal content (Uses the hidden divs)
        const modalData = {
            'intro': document.getElementById('detail-content-intro').innerHTML,
            'core_work': document.getElementById('detail-content-core_work').innerHTML,
            'system_overview': document.getElementById('detail-content-system_overview').innerHTML,
            'maintenance': document.getElementById('detail-content-maintenance').innerHTML,
            'safety': document.getElementById('detail-content-safety').innerHTML,
            'future': document.getElementById('detail-content-future').innerHTML,
            'cc_brayton_cycle': document.getElementById('detail-content-cc_brayton_cycle').innerHTML,
            'cc_rankine_cycle': document.getElementById('detail-content-cc_rankine_cycle').innerHTML,
            'cc_gasturbine': document.getElementById('detail-content-cc_gasturbine').innerHTML,
            'cc_hrsg': document.getElementById('detail-content-cc_hrsg').innerHTML,
            'cc_steamturbine': document.getElementById('detail-content-cc_steamturbine').innerHTML,
            'cc_dcs': document.getElementById('detail-content-cc_dcs').innerHTML,
            'cc_bms': document.getElementById('detail-content-cc_bms').innerHTML,
            'cc_vibration': document.getElementById('detail-content-cc_vibration').innerHTML,
            'cc_cems': document.getElementById('detail-content-cc_cems').innerHTML,
            'sp_dc_generation': document.getElementById('detail-content-sp_dc_generation').innerHTML,
            'sp_ac_conversion': document.getElementById('detail-content-sp_ac_conversion').innerHTML,
            'sp_inverters': document.getElementById('detail-content-sp_inverters').innerHTML,
            'sp_weather': document.getElementById('detail-content-sp_weather').innerHTML,
            'sp_protection': document.getElementById('detail-content-sp_protection').innerHTML,
            'sp_scada': document.getElementById('detail-content-sp_scada').innerHTML,
            'sp_tracker': document.getElementById('detail-content-sp_tracker').innerHTML,
            'sp_dccomps': document.getElementById('detail-content-sp_dccomps').innerHTML,
            'sp_ir_temp': document.getElementById('detail-content-sp_ir_temp').innerHTML,
        };

        // Modal Elements
        const modal = document.getElementById('modal');
        const modalBackdrop = document.getElementById('modal-backdrop');
        const modalContentBox = document.getElementById('modal-content-box');
        const modalTitle = document.getElementById('modal-title');
        const modalBody = document.getElementById('modal-body');
        const modalContent = document.querySelector('.modal-content'); 

        // General Sections and Links
        const contentSections = document.querySelectorAll('.content-section');
        const navLinks = document.querySelectorAll('.nav-link');
        const detailCards = document.querySelectorAll('.detail-card');
        
        /**
         * Helper function to calculate the width of the scrollbar.
         * Used to prevent layout shift when modal is open and body scrolling is disabled.
         */
        function getScrollbarWidth() {
            // Create a temporary element to measure
            const outer = document.createElement('div');
            outer.style.visibility = 'hidden';
            outer.style.overflow = 'scroll'; // Show scrollbar
            outer.style.msOverflowStyle = 'scrollbar'; // IE
            document.body.appendChild(outer);

            const inner = document.createElement('div');
            outer.appendChild(inner);

            // Calculate width by subtracting the inner width from the outer width
            const scrollbarWidth = (outer.offsetWidth - inner.offsetWidth);

            // Remove the temporary element
            outer.parentNode.removeChild(outer);

            return scrollbarWidth;
        }

        // Function to show the content section
        function showSection(sectionId) {
            contentSections.forEach(section => {
                // Initial hide/fade out
                if (section.id !== sectionId) {
                    section.classList.add('hidden');
                    section.style.opacity = '0';
                }
            });

            // Fade in/show active section
            const activeSection = document.getElementById(sectionId);
            if (activeSection) {
                activeSection.classList.remove('hidden');
                // Use setTimeout for transition to work after removing 'hidden'
                setTimeout(() => {
                    activeSection.style.opacity = '1';
                }, 10); 
            }

	        window.scrollTo({ top: 0, behavior: 'smooth' });

            // Update active link style
            navLinks.forEach(link => {
                link.classList.remove('nav-active-link', 'font-bold');
            });

            // Set active style for the main link or the parent link
            let activeLink = document.querySelector(`.nav-link[data-target="${sectionId}"]`);
            if (activeLink) {
                activeLink.classList.add('nav-active-link', 'font-bold');
            } else {
                // Check if it's a dropdown item (like combined_cycle) and set the parent ('training') as active
                const parentLink = document.querySelector(`.nav-dropdown-link[data-target="${sectionId}"]`);
                const parentId = parentLink?.getAttribute('data-parent-target');
                if (parentId) {
                    activeLink = document.querySelector(`.nav-link[data-target="${parentId}"]`);
                    activeLink?.classList.add('nav-active-link', 'font-bold');
                }
            }
        }

        // Function to open the detail modal
        function openModal(detailId) {
            const content = modalData[detailId];
            if (!content) return;

            // Extract the title (h3) and topic (span) from the content
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = content;
            const titleElement = tempDiv.querySelector('h3');
            const topicElement = tempDiv.querySelector('span[id^="detail-topic-"]');
            
            // Set modal title
            modalTitle.textContent = titleElement ? titleElement.textContent : 'Detail Information';
            
            // Remove the title and topic span from the body content before inserting
            if (titleElement) titleElement.remove();
            if (topicElement) topicElement.remove();
            
            modalBody.innerHTML = tempDiv.innerHTML;
            
            // Show modal and apply transition classes
            modal.classList.remove('hidden');
            
            // NEW FIX: Add padding to body to prevent layout shift from scrollbar disappearing
            // Only apply this fix if the body currently has a scrollbar
            const scrollbarWidth = getScrollbarWidth();
            const hasScrollbar = document.body.scrollHeight > window.innerHeight;
            
            if (hasScrollbar && scrollbarWidth > 0) {
                 document.body.style.paddingRight = `${scrollbarWidth}px`;
            }

            // NEW FIX: Hide the scrollbar without setting overflow: hidden on the body
            // We use fixed positioning on the body for the main scrollbar to be ignored, 
            // and the modal will handle its own scrolling (which is already set via max-h-[90vh] overflow-y-auto)
            document.body.style.overflow = 'hidden'; 

            setTimeout(() => {
                modalBackdrop.classList.remove('bg-opacity-75'); // Removed from HTML, now set via JS
                modalBackdrop.style.opacity = '0.75';
                modalContentBox.classList.remove('scale-95', 'opacity-0');
                modalContentBox.classList.add('scale-100', 'opacity-100');
            }, 10);
        }

        // Function to close the detail modal
        function closeModal() {
            modalBackdrop.style.opacity = '0';
            modalContentBox.classList.remove('scale-100', 'opacity-100');
            modalContentBox.classList.add('scale-95', 'opacity-0');
            
            // Revert changes after transition is complete
            setTimeout(() => {
                modal.classList.add('hidden');

                // NEW FIX: Restore body styles to re-enable scrolling and remove padding
                document.body.style.overflow = '';
                document.body.style.paddingRight = ''; 
            }, 300); // Wait for the transition to finish
        }

        // Initialize on DOMContentLoaded
        document.addEventListener('DOMContentLoaded', () => {
            // Set 'Overview' as default active section
            showSection('overview');

            // 1. Event Listener for Detail Cards to open Modal
            detailCards.forEach(card => {
                card.addEventListener('click', () => {
                    const detailId = card.dataset.detail;
                    openModal(detailId);
                });
            });
            
            // 2. Event Listener for Menu Links (including Dropdown Links) to switch sections
            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    // Prevent default for main links that only serve as dropdown headers (href="#")
                    if (link.getAttribute('href') === '#') {
                        e.preventDefault(); 
                        return;
                    }
                    
                    e.preventDefault(); 
                    const sectionId = link.getAttribute('data-target');
                    showSection(sectionId);
                    
                    // Close dropdown menu after clicking an item
                    if (link.classList.contains('nav-dropdown-link')) {
                         // Use .group-hover to control the dropdown state, no immediate hiding is needed for good UX
                         // However, to force hide *after* a click, we can set display to none.
                         link.closest('.dropdown').querySelector('.dropdown-menu').style.display = 'none';
                    }
                });
            });


            // 3. Event Listener for Modal Backdrop/Outside click to close modal
            modalBackdrop.addEventListener('click', closeModal);
		
            modalContentBox.addEventListener('click', (e) => {
                // Close if click is directly on the modal content box (outside the inner content)
            	if (e.target === modalContentBox) {
            		closeModal();
       	        }
	        });
            
            // 4. Stop click propagation inside the modal content
            if (modalContent) {
                modalContent.addEventListener('click', (e) => {
                    e.stopPropagation(); 
                });
            }

            // 5. Close Modal on Escape key press
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && !modal.classList.contains('hidden')) {
                    closeModal();
                }
            });

            // 6. Manage Dropdown display state on hover
            document.querySelectorAll('.dropdown').forEach(dropdown => {
                const dropdownMenu = dropdown.querySelector('.dropdown-menu');
                // Use mouseenter/mouseleave to ensure display: block is set, overriding the initial CSS 'display: none'
                dropdown.addEventListener('mouseenter', () => {
                    dropdownMenu.style.display = 'block';
                });
                dropdown.addEventListener('mouseleave', () => {
                    // Use a short delay before hiding
                    setTimeout(() => {
                        if (!dropdown.matches(':hover')) {
                            dropdownMenu.style.display = 'none';
                        }
                    }, 500); 
                });
            });
        });
    </script>

</body>
</html>

